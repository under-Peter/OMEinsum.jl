<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic usage · OMEinsum.jl</title><meta name="title" content="Basic usage · OMEinsum.jl"/><meta property="og:title" content="Basic usage · OMEinsum.jl"/><meta property="twitter:title" content="Basic usage · OMEinsum.jl"/><meta name="description" content="Documentation for OMEinsum.jl."/><meta property="og:description" content="Documentation for OMEinsum.jl."/><meta property="twitter:description" content="Documentation for OMEinsum.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">OMEinsum.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../background/">Background: Tensor Networks</a></li><li class="is-active"><a class="tocitem" href>Basic usage</a><ul class="internal"><li><a class="tocitem" href="#Einsum-notation"><span>Einsum notation</span></a></li><li><a class="tocitem" href="#Einsum-examples"><span>Einsum examples</span></a></li></ul></li><li><a class="tocitem" href="../contractionorder/">Contraction order optimization</a></li><li><a class="tocitem" href="../autodiff/">Automatic differentiation</a></li><li><a class="tocitem" href="../cuda/">CUDA</a></li><li><a class="tocitem" href="../applications/">Applications</a></li><li><a class="tocitem" href="../docstrings/">Manual</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Basic usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basic usage</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/under-Peter/OMEinsum.jl/blob/master/docs/src/basic.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h1><p>In the following example, we demonstrate the einsum notation for basic tensor operations.</p><h2 id="Einsum-notation"><a class="docs-heading-anchor" href="#Einsum-notation">Einsum notation</a><a id="Einsum-notation-1"></a><a class="docs-heading-anchor-permalink" href="#Einsum-notation" title="Permalink"></a></h2><p>To specify the operation, the user can either use the <a href="../docstrings/#OMEinsum.@ein_str-Tuple{AbstractString}"><code>@ein_str</code></a>-string literal or the <a href="../docstrings/#OMEinsum.EinCode"><code>EinCode</code></a> object. For example, both the following code snippets define the matrix multiplication operation:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using OMEinsum</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; code1 = ein&quot;ij,jk -&gt; ik&quot;  # the string literal</code><code class="nohighlight hljs ansi" style="display:block;">ij, jk -&gt; ik</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ixs = [[1, 2], [2, 3]]  # the input indices</code><code class="nohighlight hljs ansi" style="display:block;">2-element Vector{Vector{Int64}}:
 [1, 2]
 [2, 3]</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; iy = [1, 3]  # the output indices</code><code class="nohighlight hljs ansi" style="display:block;">2-element Vector{Int64}:
 1
 3</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; code2 = EinCode(ixs, iy)  # the EinCode object (equivalent to the string literal)</code><code class="nohighlight hljs ansi" style="display:block;">1∘2, 2∘3 -&gt; 1∘3</code></pre><p>The <a href="../docstrings/#OMEinsum.@ein_str-Tuple{AbstractString}"><code>@ein_str</code></a> macro can be used to define the einsum notation directly in the function call.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; A, B = randn(2, 3), randn(3, 4);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; code1(A, B)  # matrix multiplication</code><code class="nohighlight hljs ansi" style="display:block;">2×4 Matrix{Float64}:
 0.692135   0.406267  -0.515683  -0.577262
 0.993061  -0.591599  -0.515235  -0.374355</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; size_dict = OMEinsum.get_size_dict(getixsv(code1), (A, B))  # get the size of the labels</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Char, Int64} with 3 entries:
  &#39;j&#39; =&gt; 3
  &#39;i&#39; =&gt; 2
  &#39;k&#39; =&gt; 4</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; einsum(code1, (A, B), size_dict)  # lower-level function</code><code class="nohighlight hljs ansi" style="display:block;">2×4 Matrix{Float64}:
 0.692135   0.406267  -0.515683  -0.577262
 0.993061  -0.591599  -0.515235  -0.374355</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; einsum!(code1, (A, B), zeros(2, 4), true, false, size_dict)  # the in-place operation</code><code class="nohighlight hljs ansi" style="display:block;">2×4 Matrix{Float64}:
 0.692135   0.406267  -0.515683  -0.577262
 0.993061  -0.591599  -0.515235  -0.374355</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @ein C[i,k] := A[i,j] * B[j,k]  # all-in-one macro</code><code class="nohighlight hljs ansi" style="display:block;">2×4 Matrix{Float64}:
 0.692135   0.406267  -0.515683  -0.577262
 0.993061  -0.591599  -0.515235  -0.374355</code></pre><p>Here, we show that the <a href="../docstrings/#OMEinsum.@ein-Tuple"><code>@ein</code></a> macro combines the einsum notation defintion and the operation in a single line, which is more convenient for simple operations. Separating the einsum notation and the operation (the first approach) can be useful for reusing the einsum notation for multiple input tensors. Lower level functions, <a href="../docstrings/#OMEinsum.einsum"><code>einsum</code></a> and <a href="../docstrings/#OMEinsum.einsum!"><code>einsum!</code></a>, can be used for more control over the operation.</p><p>For more than two input tensors, <em>the <a href="../docstrings/#OMEinsum.@ein_str-Tuple{AbstractString}"><code>@ein_str</code></a> macro does not optimize the contraction order</em>. In such cases, the user can use the <a href="../docstrings/#OMEinsum.@optein_str-Tuple{AbstractString}"><code>@optein_str</code></a> string literal to optimize the contraction order or specify the contraction order manually.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; tensors = [randn(100, 100) for _ in 1:4];</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; optein&quot;ij,jk,kl,lm-&gt;im&quot;(tensors...)  # optimized contraction (without knowing the size)</code><code class="nohighlight hljs ansi" style="display:block;">100×100 Matrix{Float64}:
   408.786   1044.4     -1792.32   …   1466.85     -704.774    -627.413
  -865.972    299.559     806.24       -915.918    -175.222   -1464.66
   311.652   -450.211     696.154      -381.354     624.871   -1035.73
  -454.036  -1698.95      525.819       607.269    -418.633    -901.877
 -1377.23    -973.359    2071.93       -323.652    1858.31     -618.578
  -291.711  -1004.38     -748.132  …   -285.473    -216.704    -631.643
  1039.49     162.85     -457.461      -404.858   -1025.63    -1134.0
  -606.901   -690.866    -278.21       -715.723     -11.2877    904.286
  1533.17   -1128.94     -648.311     -2031.09      319.659     921.207
  -343.94   -1128.26     1101.57       1461.77      996.874    1427.88
     ⋮                             ⋱
   504.422     69.9809    534.062     -1173.7      -235.199   -1133.24
   281.89    1071.41    -1654.21      -2091.68     -542.6     -1960.56
   660.625   1073.41    -1165.24       1547.16       39.6034     46.7819
  2138.86    -106.948   -1534.22       -411.825    -943.257    -921.584
  1491.27     948.335    1412.18   …  -1298.14     -267.395   -1427.85
  -456.467  -1481.17     -251.208       280.399     568.569      51.1229
  -764.131   -979.891     525.183     -1616.26    -1240.71       21.5721
 -1234.65    1053.1       266.023        56.2822    863.863     759.705
  -323.952   1109.56    -1200.5         638.986     303.736    1093.66</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;(ij,jk),(kl,lm)-&gt;im&quot;(tensors...)  # manually specified contraction</code><code class="nohighlight hljs ansi" style="display:block;">100×100 Matrix{Float64}:
   408.786   1044.4     -1792.32   …   1466.85     -704.774    -627.413
  -865.972    299.559     806.24       -915.918    -175.222   -1464.66
   311.652   -450.211     696.154      -381.354     624.871   -1035.73
  -454.036  -1698.95      525.819       607.269    -418.633    -901.877
 -1377.23    -973.359    2071.93       -323.652    1858.31     -618.578
  -291.711  -1004.38     -748.132  …   -285.473    -216.704    -631.643
  1039.49     162.85     -457.461      -404.858   -1025.63    -1134.0
  -606.901   -690.866    -278.21       -715.723     -11.2877    904.286
  1533.17   -1128.94     -648.311     -2031.09      319.659     921.207
  -343.94   -1128.26     1101.57       1461.77      996.874    1427.88
     ⋮                             ⋱
   504.422     69.9809    534.062     -1173.7      -235.199   -1133.24
   281.89    1071.41    -1654.21      -2091.68     -542.6     -1960.56
   660.625   1073.41    -1165.24       1547.16       39.6034     46.7819
  2138.86    -106.948   -1534.22       -411.825    -943.257    -921.584
  1491.27     948.335    1412.18   …  -1298.14     -267.395   -1427.85
  -456.467  -1481.17     -251.208       280.399     568.569      51.1229
  -764.131   -979.891     525.183     -1616.26    -1240.71       21.5721
 -1234.65    1053.1       266.023        56.2822    863.863     759.705
  -323.952   1109.56    -1200.5         638.986     303.736    1093.66</code></pre><p>Sometimes, manually optimizing the contraction order can be beneficial. Please check <a href="../contractionorder/#Contraction-order-optimization">Contraction order optimization</a> for more details.</p><h2 id="Einsum-examples"><a class="docs-heading-anchor" href="#Einsum-examples">Einsum examples</a><a id="Einsum-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Einsum-examples" title="Permalink"></a></h2><p>We first define the tensors and then demonstrate the einsum notation for various tensor operations.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using OMEinsum</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; s = fill(1)  # scalar</code><code class="nohighlight hljs ansi" style="display:block;">0-dimensional Array{Int64, 0}:
1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; w, v = [1, 2], [4, 5];  # vectors</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; A, B = [1 2; 3 4], [5 6; 7 8]; # matrices</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; T1, T2 = reshape(1:8, 2, 2, 2), reshape(9:16, 2, 2, 2); # 3D tensor</code></pre><h3 id="Unary-examples"><a class="docs-heading-anchor" href="#Unary-examples">Unary examples</a><a id="Unary-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Unary-examples" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;i-&gt;&quot;(w)  # sum of the elements of a vector.</code><code class="nohighlight hljs ansi" style="display:block;">0-dimensional Array{Int64, 0}:
3</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ij-&gt;i&quot;(A)  # sum of the rows of a matrix.</code><code class="nohighlight hljs ansi" style="display:block;">2-element Vector{Int64}:
 3
 7</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ii-&gt;&quot;(A)  # sum of the diagonal elements of a matrix, i.e., the trace.</code><code class="nohighlight hljs ansi" style="display:block;">0-dimensional Array{Int64, 0}:
5</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ij-&gt;&quot;(A)  # sum of the elements of a matrix.</code><code class="nohighlight hljs ansi" style="display:block;">0-dimensional Array{Int64, 0}:
10</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;i-&gt;ii&quot;(w)  # create a diagonal matrix.</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Int64}:
 1  0
 0  2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;i-&gt;ij&quot;(w; size_info=Dict(&#39;j&#39;=&gt;2))  # repeat a vector to form a matrix.</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Int64}:
 1  1
 2  2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ijk-&gt;ikj&quot;(T1)  # permute the dimensions of a tensor.</code><code class="nohighlight hljs ansi" style="display:block;">2×2×2 Array{Int64, 3}:
[:, :, 1] =
 1  5
 2  6

[:, :, 2] =
 3  7
 4  8</code></pre><h3 id="Binary-examples"><a class="docs-heading-anchor" href="#Binary-examples">Binary examples</a><a id="Binary-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Binary-examples" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ij, jk -&gt; ik&quot;(A, B)  # matrix multiplication.</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Int64}:
 19  22
 43  50</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ijb,jkb-&gt;ikb&quot;(T1, T2)  # batch matrix multiplication.</code><code class="nohighlight hljs ansi" style="display:block;">2×2×2 Array{Int64, 3}:
[:, :, 1] =
 39  47
 58  70

[:, :, 2] =
 163  187
 190  218</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ij,ij-&gt;ij&quot;(A, B)  # element-wise multiplication.</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Int64}:
  5  12
 21  32</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ij,ij-&gt;&quot;(A, B)  # sum of the element-wise multiplication.</code><code class="nohighlight hljs ansi" style="display:block;">0-dimensional Array{Int64, 0}:
70</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ij,-&gt;ij&quot;(A, s)  # element-wise multiplication by a scalar.</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Int64}:
 1  2
 3  4</code></pre><h3 id="Nary-examples"><a class="docs-heading-anchor" href="#Nary-examples">Nary examples</a><a id="Nary-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Nary-examples" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; optein&quot;ai,aj,ak-&gt;ijk&quot;(A, A, B)  # star contraction.</code><code class="nohighlight hljs ansi" style="display:block;">2×2×2 Array{Int64, 3}:
[:, :, 1] =
 68   94
 94  132

[:, :, 2] =
  78  108
 108  152</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; optein&quot;ia,ajb,bkc,cld,dm-&gt;ijklm&quot;(A, T1, T2, T1, A)  # tensor train contraction.</code><code class="nohighlight hljs ansi" style="display:block;">2×2×2×2×2 Array{Int64, 5}:
[:, :, 1, 1, 1] =
  9500  14564
 21604  33420

[:, :, 2, 1, 1] =
 11084  17012
 25204  39036

[:, :, 1, 2, 1] =
 13644  20916
 31028  47996

[:, :, 2, 2, 1] =
 15932  24452
 36228  56108

[:, :, 1, 1, 2] =
 13214  20258
 30050  46486

[:, :, 2, 1, 2] =
 15414  23658
 35050  54286

[:, :, 1, 2, 2] =
 19430  29786
 44186  68350

[:, :, 2, 2, 2] =
 22686  34818
 51586  79894</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../background/">« Background: Tensor Networks</a><a class="docs-footer-nextpage" href="../contractionorder/">Contraction order optimization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 19 July 2025 07:21">Saturday 19 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
