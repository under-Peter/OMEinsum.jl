<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic usage · OMEinsum.jl</title><meta name="title" content="Basic usage · OMEinsum.jl"/><meta property="og:title" content="Basic usage · OMEinsum.jl"/><meta property="twitter:title" content="Basic usage · OMEinsum.jl"/><meta name="description" content="Documentation for OMEinsum.jl."/><meta property="og:description" content="Documentation for OMEinsum.jl."/><meta property="twitter:description" content="Documentation for OMEinsum.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">OMEinsum.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../background/">Background: Tensor Networks</a></li><li class="is-active"><a class="tocitem" href>Basic usage</a><ul class="internal"><li><a class="tocitem" href="#Einsum-notation"><span>Einsum notation</span></a></li><li><a class="tocitem" href="#Einsum-examples"><span>Einsum examples</span></a></li><li><a class="tocitem" href="#Computation-Backends"><span>Computation Backends</span></a></li></ul></li><li><a class="tocitem" href="../contractionorder/">Contraction order optimization</a></li><li><a class="tocitem" href="../autodiff/">Automatic differentiation</a></li><li><a class="tocitem" href="../cuda/">CUDA</a></li><li><a class="tocitem" href="../applications/">Applications</a></li><li><a class="tocitem" href="../docstrings/">Manual</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Basic usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basic usage</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/under-Peter/OMEinsum.jl/blob/master/docs/src/basic.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h1><p>In the following example, we demonstrate the einsum notation for basic tensor operations.</p><h2 id="Einsum-notation"><a class="docs-heading-anchor" href="#Einsum-notation">Einsum notation</a><a id="Einsum-notation-1"></a><a class="docs-heading-anchor-permalink" href="#Einsum-notation" title="Permalink"></a></h2><p>To specify the operation, the user can either use the <a href="../docstrings/#OMEinsum.@ein_str-Tuple{AbstractString}"><code>@ein_str</code></a>-string literal or the <a href="../docstrings/#OMEinsum.EinCode"><code>EinCode</code></a> object. For example, both the following code snippets define the matrix multiplication operation:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using OMEinsum</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; code1 = ein&quot;ij,jk -&gt; ik&quot;  # the string literal</code><code class="nohighlight hljs ansi" style="display:block;">ij, jk -&gt; ik</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ixs = [[1, 2], [2, 3]]  # the input indices</code><code class="nohighlight hljs ansi" style="display:block;">2-element Vector{Vector{Int64}}:
 [1, 2]
 [2, 3]</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; iy = [1, 3]  # the output indices</code><code class="nohighlight hljs ansi" style="display:block;">2-element Vector{Int64}:
 1
 3</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; code2 = EinCode(ixs, iy)  # the EinCode object (equivalent to the string literal)</code><code class="nohighlight hljs ansi" style="display:block;">1∘2, 2∘3 -&gt; 1∘3</code></pre><p>The <a href="../docstrings/#OMEinsum.@ein_str-Tuple{AbstractString}"><code>@ein_str</code></a> macro can be used to define the einsum notation directly in the function call.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; A, B = randn(2, 3), randn(3, 4);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; code1(A, B)  # matrix multiplication</code><code class="nohighlight hljs ansi" style="display:block;">2×4 Matrix{Float64}:
 0.793197  -2.92972   0.411844    -2.11352
 1.19467    1.84704  -0.00657447  -3.74979</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; size_dict = OMEinsum.get_size_dict(getixsv(code1), (A, B))  # get the size of the labels</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Char, Int64} with 3 entries:
  &#39;j&#39; =&gt; 3
  &#39;i&#39; =&gt; 2
  &#39;k&#39; =&gt; 4</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; einsum(code1, (A, B), size_dict)  # lower-level function</code><code class="nohighlight hljs ansi" style="display:block;">2×4 Matrix{Float64}:
 0.793197  -2.92972   0.411844    -2.11352
 1.19467    1.84704  -0.00657447  -3.74979</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; einsum!(code1, (A, B), zeros(2, 4), true, false, size_dict)  # the in-place operation</code><code class="nohighlight hljs ansi" style="display:block;">2×4 Matrix{Float64}:
 0.793197  -2.92972   0.411844    -2.11352
 1.19467    1.84704  -0.00657447  -3.74979</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @ein C[i,k] := A[i,j] * B[j,k]  # all-in-one macro</code><code class="nohighlight hljs ansi" style="display:block;">2×4 Matrix{Float64}:
 0.793197  -2.92972   0.411844    -2.11352
 1.19467    1.84704  -0.00657447  -3.74979</code></pre><p>Here, we show that the <a href="../docstrings/#OMEinsum.@ein-Tuple"><code>@ein</code></a> macro combines the einsum notation defintion and the operation in a single line, which is more convenient for simple operations. Separating the einsum notation and the operation (the first approach) can be useful for reusing the einsum notation for multiple input tensors. Lower level functions, <a href="../docstrings/#OMEinsum.einsum"><code>einsum</code></a> and <a href="../docstrings/#OMEinsum.einsum!"><code>einsum!</code></a>, can be used for more control over the operation.</p><p>For more than two input tensors, <em>the <a href="../docstrings/#OMEinsum.@ein_str-Tuple{AbstractString}"><code>@ein_str</code></a> macro does not optimize the contraction order</em>. In such cases, the user can use the <a href="../docstrings/#OMEinsum.@optein_str-Tuple{AbstractString}"><code>@optein_str</code></a> string literal to optimize the contraction order or specify the contraction order manually.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; tensors = [randn(100, 100) for _ in 1:4];</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; optein&quot;ij,jk,kl,lm-&gt;im&quot;(tensors...)  # optimized contraction (without knowing the size)</code><code class="nohighlight hljs ansi" style="display:block;">100×100 Matrix{Float64}:
   122.38      419.784   -136.118  …    944.783     -236.719     939.54
  -384.893     552.112    421.077     -1534.18       801.648     660.99
   113.018   -1577.27     798.243        17.7191     344.921    -656.564
   135.115    -643.648   -756.631       116.574      701.689   -1011.93
 -1299.75     -971.882   -686.79        615.853     1167.8       613.823
  1951.84      339.593   -493.932  …   2019.94     -1492.66     -810.978
   526.575     119.372   1710.63        352.464       53.9234    831.373
   793.027     697.02    1269.05         -3.92559    101.851    -267.461
  -172.778   -1073.2     -792.61         33.3994     744.446      81.0614
 -1218.34     1206.38    -522.196      -115.365      776.141     270.539
     ⋮                             ⋱
 -1317.66     1012.17    -917.664      -327.721     -173.098    -355.755
   -81.5206   -339.106   -895.996     -1884.33       -39.8454   -846.425
  1797.8      -986.44    1799.9        -131.399     -743.83      919.23
   -30.6691    316.19    -948.152       807.311    -1340.9       323.021
  2070.04     1303.01     560.809  …   1165.6       -946.105    1292.56
  -616.393   -1848.82     622.314       -21.6757    -915.7       665.81
  1110.22      289.277    -75.255      1088.72      -792.083      70.8986
  -858.774    1028.65     297.003       834.256      -85.2747     95.8203
  1343.16       81.4703   385.21       -736.114     -303.881     -65.4353</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;(ij,jk),(kl,lm)-&gt;im&quot;(tensors...)  # manually specified contraction</code><code class="nohighlight hljs ansi" style="display:block;">100×100 Matrix{Float64}:
   122.38      419.784   -136.118  …    944.783     -236.719     939.54
  -384.893     552.112    421.077     -1534.18       801.648     660.99
   113.018   -1577.27     798.243        17.7191     344.921    -656.564
   135.115    -643.648   -756.631       116.574      701.689   -1011.93
 -1299.75     -971.882   -686.79        615.853     1167.8       613.823
  1951.84      339.593   -493.932  …   2019.94     -1492.66     -810.978
   526.575     119.372   1710.63        352.464       53.9234    831.373
   793.027     697.02    1269.05         -3.92559    101.851    -267.461
  -172.778   -1073.2     -792.61         33.3994     744.446      81.0614
 -1218.34     1206.38    -522.196      -115.365      776.141     270.539
     ⋮                             ⋱
 -1317.66     1012.17    -917.664      -327.721     -173.098    -355.755
   -81.5206   -339.106   -895.996     -1884.33       -39.8454   -846.425
  1797.8      -986.44    1799.9        -131.399     -743.83      919.23
   -30.6691    316.19    -948.152       807.311    -1340.9       323.021
  2070.04     1303.01     560.809  …   1165.6       -946.105    1292.56
  -616.393   -1848.82     622.314       -21.6757    -915.7       665.81
  1110.22      289.277    -75.255      1088.72      -792.083      70.8986
  -858.774    1028.65     297.003       834.256      -85.2747     95.8203
  1343.16       81.4703   385.21       -736.114     -303.881     -65.4353</code></pre><p>Sometimes, manually optimizing the contraction order can be beneficial. Please check <a href="../contractionorder/#Contraction-order-optimization">Contraction order optimization</a> for more details.</p><h2 id="Einsum-examples"><a class="docs-heading-anchor" href="#Einsum-examples">Einsum examples</a><a id="Einsum-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Einsum-examples" title="Permalink"></a></h2><p>We first define the tensors and then demonstrate the einsum notation for various tensor operations.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using OMEinsum</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; s = fill(1)  # scalar</code><code class="nohighlight hljs ansi" style="display:block;">0-dimensional Array{Int64, 0}:
1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; w, v = [1, 2], [4, 5];  # vectors</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; A, B = [1 2; 3 4], [5 6; 7 8]; # matrices</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; T1, T2 = reshape(1:8, 2, 2, 2), reshape(9:16, 2, 2, 2); # 3D tensor</code></pre><h3 id="Unary-examples"><a class="docs-heading-anchor" href="#Unary-examples">Unary examples</a><a id="Unary-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Unary-examples" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;i-&gt;&quot;(w)  # sum of the elements of a vector.</code><code class="nohighlight hljs ansi" style="display:block;">0-dimensional Array{Int64, 0}:
3</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ij-&gt;i&quot;(A)  # sum of the rows of a matrix.</code><code class="nohighlight hljs ansi" style="display:block;">2-element Vector{Int64}:
 3
 7</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ii-&gt;&quot;(A)  # sum of the diagonal elements of a matrix, i.e., the trace.</code><code class="nohighlight hljs ansi" style="display:block;">0-dimensional Array{Int64, 0}:
5</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ij-&gt;&quot;(A)  # sum of the elements of a matrix.</code><code class="nohighlight hljs ansi" style="display:block;">0-dimensional Array{Int64, 0}:
10</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;i-&gt;ii&quot;(w)  # create a diagonal matrix.</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Int64}:
 1  0
 0  2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;i-&gt;ij&quot;(w; size_info=Dict(&#39;j&#39;=&gt;2))  # repeat a vector to form a matrix.</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Int64}:
 1  1
 2  2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ijk-&gt;ikj&quot;(T1)  # permute the dimensions of a tensor.</code><code class="nohighlight hljs ansi" style="display:block;">2×2×2 Array{Int64, 3}:
[:, :, 1] =
 1  5
 2  6

[:, :, 2] =
 3  7
 4  8</code></pre><h3 id="Binary-examples"><a class="docs-heading-anchor" href="#Binary-examples">Binary examples</a><a id="Binary-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Binary-examples" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ij, jk -&gt; ik&quot;(A, B)  # matrix multiplication.</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Int64}:
 19  22
 43  50</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ijb,jkb-&gt;ikb&quot;(T1, T2)  # batch matrix multiplication.</code><code class="nohighlight hljs ansi" style="display:block;">2×2×2 Array{Int64, 3}:
[:, :, 1] =
 39  47
 58  70

[:, :, 2] =
 163  187
 190  218</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ij,ij-&gt;ij&quot;(A, B)  # element-wise multiplication.</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Int64}:
  5  12
 21  32</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ij,ij-&gt;&quot;(A, B)  # sum of the element-wise multiplication.</code><code class="nohighlight hljs ansi" style="display:block;">0-dimensional Array{Int64, 0}:
70</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ein&quot;ij,-&gt;ij&quot;(A, s)  # element-wise multiplication by a scalar.</code><code class="nohighlight hljs ansi" style="display:block;">2×2 Matrix{Int64}:
 1  2
 3  4</code></pre><h3 id="Nary-examples"><a class="docs-heading-anchor" href="#Nary-examples">Nary examples</a><a id="Nary-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Nary-examples" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; optein&quot;ai,aj,ak-&gt;ijk&quot;(A, A, B)  # star contraction.</code><code class="nohighlight hljs ansi" style="display:block;">2×2×2 Array{Int64, 3}:
[:, :, 1] =
 68   94
 94  132

[:, :, 2] =
  78  108
 108  152</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; optein&quot;ia,ajb,bkc,cld,dm-&gt;ijklm&quot;(A, T1, T2, T1, A)  # tensor train contraction.</code><code class="nohighlight hljs ansi" style="display:block;">2×2×2×2×2 Array{Int64, 5}:
[:, :, 1, 1, 1] =
  9500  14564
 21604  33420

[:, :, 2, 1, 1] =
 11084  17012
 25204  39036

[:, :, 1, 2, 1] =
 13644  20916
 31028  47996

[:, :, 2, 2, 1] =
 15932  24452
 36228  56108

[:, :, 1, 1, 2] =
 13214  20258
 30050  46486

[:, :, 2, 1, 2] =
 15414  23658
 35050  54286

[:, :, 1, 2, 2] =
 19430  29786
 44186  68350

[:, :, 2, 2, 2] =
 22686  34818
 51586  79894</code></pre><h2 id="Computation-Backends"><a class="docs-heading-anchor" href="#Computation-Backends">Computation Backends</a><a id="Computation-Backends-1"></a><a class="docs-heading-anchor-permalink" href="#Computation-Backends" title="Permalink"></a></h2><p>OMEinsum supports multiple backends for tensor contractions. The backend determines how the underlying computation is performed.</p><h3 id="Available-Backends"><a class="docs-heading-anchor" href="#Available-Backends">Available Backends</a><a id="Available-Backends-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Backends" title="Permalink"></a></h3><table><tr><th style="text-align: right">Backend</th><th style="text-align: right">Description</th><th style="text-align: right">Best For</th></tr><tr><td style="text-align: right"><code>DefaultBackend()</code></td><td style="text-align: right">BLAS/CUBLAS via reshape/permute</td><td style="text-align: right">General use, matrix operations</td></tr><tr><td style="text-align: right"><code>CuTensorBackend()</code></td><td style="text-align: right">NVIDIA cuTENSOR</td><td style="text-align: right">GPU tensor network contractions</td></tr></table><h3 id="Changing-Backends"><a class="docs-heading-anchor" href="#Changing-Backends">Changing Backends</a><a id="Changing-Backends-1"></a><a class="docs-heading-anchor-permalink" href="#Changing-Backends" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; get_einsum_backend()  # check current backend</code><code class="nohighlight hljs ansi" style="display:block;">DefaultBackend()</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; set_einsum_backend!(DefaultBackend())  # set to default</code><code class="nohighlight hljs ansi" style="display:block;">DefaultBackend()</code></pre><p>For GPU acceleration with cuTENSOR, see <a href="../cuda/#CUDA-Acceleration">CUDA Acceleration</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../background/">« Background: Tensor Networks</a><a class="docs-footer-nextpage" href="../contractionorder/">Contraction order optimization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 26 December 2025 09:11">Friday 26 December 2025</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
